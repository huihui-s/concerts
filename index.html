<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的演唱會紀錄</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 10px;
        }

        /* 新增紀錄表單 */
        .record-form {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
        }

        .record-form h2 {
            text-align: center;
            color: #34495e;
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        .record-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .record-form input[type="text"],
        .record-form input[type="date"],
        .record-form textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            box-sizing: border-box; /* 確保 padding 不增加寬度 */
        }

        .record-form textarea {
            resize: vertical;
            min-height: 80px;
        }

        .record-form button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .record-form button:hover {
            background-color: #45a049;
        }

        .message-area {
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
            color: #d35400;
        }

        /* 演唱會卡片區塊 */
        .concert-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 20px; /* 卡片間距 */
            justify-content: center; /* 水平居中 */
        }

        .concert-card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex; /* 使用 Flexbox 進行圖片和文字排版 */
            width: 100%; /* 確保在任何螢幕尺寸下都單列顯示 */
            max-width: 600px; /* 設定最大寬度以避免在超寬螢幕上過大 */
            min-height: 180px; /* 設定最小高度確保卡片高度一致 */
            height: auto; /* 讓高度根據內容調整，但結合 min-height 確保一致性 */
            box-sizing: border-box;
            position: relative; /* 用於票根效果定位 */
            padding-bottom: 10px; /* 為票根效果預留空間 */
        }

        .concert-card-image {
            flex: 0 0 40%; /* 圖片佔卡片寬度的40% */
            overflow: hidden;
            border-top-left-radius: 12px;
            border-bottom-left-radius: 12px;
        }

        .concert-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 圖片適應性縮放，填充容器並裁切 */
            display: block;
        }

        .concert-card-content {
            flex: 1; /* 文字內容佔剩餘空間，即60% */
            padding: 15px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center; /* 垂直居中內容 */
        }

        .concert-card h3 {
            font-size: 1.5em; /* 演唱會名稱更大 */
            font-weight: bold; /* 粗體 */
            margin-top: 0;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .concert-card p {
            font-size: 0.95em;
            margin-bottom: 5px;
            color: #555;
        }

        .concert-card p strong {
            color: #34495e;
        }

        /* 票根效果 */
        .ticket-style {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 10px; /* 票根效果的高度 */
            background-image:
                /* 上層半圓，向下凹陷 */
                radial-gradient(circle at 5px -5px, transparent 10px, #ffffff 10px),
                radial-gradient(circle at 5px 15px, #ffffff 10px, transparent 10px);
            background-size: 10px 20px; /* 每個半圓的寬高 */
            background-repeat: repeat-x; /* 水平重複 */
            background-position: 0 0; /* 起始位置 */
        }
        /* 右側票根效果 */
        .ticket-style::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 10px; /* 票根效果的寬度 */
            height: 100%;
            background-image:
                /* 右側半圓，向左凹陷 */
                radial-gradient(circle at -5px 5px, transparent 10px, #ffffff 10px),
                radial-gradient(circle at 15px 5px, #ffffff 10px, transparent 10px);
            background-size: 20px 10px; /* 每個半圓的寬高 */
            background-repeat: repeat-y; /* 垂直重複 */
            background-position: 0 0; /* 起始位置 */
        }
        /* 左側票根效果 */
        .ticket-style::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 10px; /* 票根效果的寬度 */
            height: 100%;
            background-image:
                /* 左側半圓，向右凹陷 */
                radial-gradient(circle at 15px 5px, transparent 10px, #ffffff 10px),
                radial-gradient(circle at -5px 5px, #ffffff 10px, transparent 10px);
            background-size: 20px 10px; /* 每個半圓的寬高 */
            background-repeat: repeat-y; /* 垂直重複 */
            background-position: 0 0; /* 起始位置 */
        }


        /* 媒體查詢：針對小螢幕調整 */
        @media (max-width: 768px) {
            .concert-card {
                flex-direction: column; /* 小螢幕下圖片和文字垂直堆疊 */
            }

            .concert-card-image {
                flex: none; /* 取消 flex 屬性 */
                width: 100%; /* 圖片佔滿寬度 */
                height: 200px; /* 設定一個固定高度或根據需求調整 */
                border-bottom-left-radius: 0;
                border-top-right-radius: 12px; /* 調整圓角 */
            }

            .concert-card-image img {
                height: 100%; /* 確保圖片填充高度 */
            }

            .concert-card-content {
                flex: none;
                width: 100%;
                padding-top: 10px; /* 調整內邊距 */
                border-top-left-radius: 0; /* 調整圓角 */
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>我的演唱會紀錄</h1>
    </header>

    <div class="container">
        <section class="record-form">
            <h2>新增演唱會紀錄</h2>
            <form id="concertForm">
                <label for="concertName">演唱會名稱:</label>
                <input type="text" id="concertName" name="concertName" required>

                <label for="artist">藝人/樂團:</label>
                <input type="text" id="artist" name="artist" required>

                <label for="date">日期:</label>
                <input type="date" id="date" name="date" required>

                <label for="location">地點:</label>
                <input type="text" id="location" name="location" required>

                <label for="imageUrl">圖片網址 (可選):</label>
                <input type="text" id="imageUrl" name="imageUrl">

                <label for="notes">備註 (可選):</label>
                <textarea id="notes" name="notes"></textarea>

                <button type="submit">新增紀錄</button>
                <p class="message-area" id="formMessage"></p>
            </form>
        </section>

        <section class="concert-grid" id="concertsContainer">
            <h2>我的演唱會列表</h2>
            <div class="concert-card">
                <div class="concert-card-image">
                    <img src="https://via.placeholder.com/200x150?text=Concert+Image" alt="演唱會圖片">
                </div>
                <div class="concert-card-content">
                    <h3>範例演唱會名稱</h3>
                    <p><strong>藝人:</strong> 範例藝人</p>
                    <p><strong>日期:</strong> 2024-07-15</p>
                    <p><strong>地點:</strong> 範例場館</p>
                    <p>這是一個範例演唱會紀錄的內容。</p>
                </div>
                <div class="ticket-style"></div>
            </div>

             <div class="concert-card">
                <div class="concert-card-image">
                    <img src="https://via.placeholder.com/200x150?text=Another+Concert" alt="演唱會圖片">
                </div>
                <div class="concert-card-content">
                    <h3>另一場演唱會</h3>
                    <p><strong>藝人:</strong> 測試樂團</p>
                    <p><strong>日期:</strong> 2024-08-01</p>
                    <p><strong>地點:</strong> 某個地方</p>
                    <p>這是一個另一個範例演唱會紀錄的內容。</p>
                </div>
                <div class="ticket-style"></div>
            </div>
        </section>
    </div>

    <script>
        // 將此替換為您部署的 Google Apps Script Web 應用程式 URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxAy0SBDS8oeFMRD5tFRQyLJMQweUFyGAoEjjYlmbGKbEVCHHGukMNznELGDUQPe-xZsQ/exec';

        document.getElementById('concertForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // 阻止表單預設提交行為

            const formMessage = document.getElementById('formMessage');
            formMessage.textContent = '正在提交...';
            formMessage.style.color = '#d35400';

            const formData = {
                concertName: document.getElementById('concertName').value,
                artist: document.getElementById('artist').value,
                date: document.getElementById('date').value,
                location: document.getElementById('location').value,
                imageUrl: document.getElementById('imageUrl').value,
                notes: document.getElementById('notes').value
            };

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'cors', // 必須開啟 CORS
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.result === 'success') {
                    formMessage.textContent = '紀錄新增成功！';
                    formMessage.style.color = '#27ae60';
                    document.getElementById('concertForm').reset(); // 清空表單
                    // 在此處可以考慮動態將新紀錄添加到頁面上，或提示用戶刷新頁面
                } else {
                    formMessage.textContent = '新增失敗: ' + result.message;
                    formMessage.style.color = '#c0392b';
                }
            } catch (error) {
                console.error('Error:', error);
                formMessage.textContent = '提交時發生錯誤。請檢查網路或稍後再試。';
                formMessage.style.color = '#c0392b';
            }
        });

        // 可以在這裡添加一個函數，用於從 Google Sheet 讀取資料並顯示在頁面上
        // 這需要 Apps Script 的 doGet 函數也能回傳資料，並且需要處理更多的 CORS 設定
        // 為了簡化，目前只實現了資料寫入
        async function loadConcerts() {
            // 由於 Apps Script 部署為 Web App 時，doGet 預設是回傳 HTML 頁面
            // 如果要讀取資料，Apps Script 需要另一個 doGet 函數返回 JSON
            // 且部署為 "Execute as: Me" 和 "Who has access: Anyone" 並進行授權
            // 為了簡化，此處暫不實作從 Apps Script 讀取資料的功能
            // 您可以手動在 index.html 中添加一些範例卡片。
            console.log("此範例主要展示數據寫入功能。如需讀取，Apps Script 端需額外開發。");
        }

        // 頁面載入時載入現有紀錄 (目前為佔位符)
        document.addEventListener('DOMContentLoaded', loadConcerts);
    </script>
</body>
</html>